<app-page-header [headerData]="headerData.data"></app-page-header>
<div class="container-fluid overflow-y-auto">
  <div class="row p-3 ar-page-content overflow-y-auto">
    <div class="col">
      @if (job$ | async; as job) {
        <div class="row">
          <div class="col-md-6">
            <h5 class="fw-bold pb-2 ar-heading">Job Number</h5>
            <section>
              <p class="pb-4 ar-job-detail__job-number">{{ job.job_number }}</p>
            </section>
            <h5 class="fw-bold pb-2 ar-heading">Job Site</h5>
            <section>
              <p class="pb-4 ar-job-detail__site-name">
                @if (job.site) {
                  @if (job.site.name) {
                    <a href="#" [routerLink]="`/sites/${job.site.site_id}`">{{ job.site.name }}</a
                    ><br />
                  }
                  {{ job.site.address1 }}<br />
                  @if (job.site.address2) {
                    {{ job.site.address2 }}<br />
                  }
                  {{ job.site.city }}, {{ job.site.state }} {{ job.site.zip_code }}
                } @else {
                  TBD
                }
              </p>
            </section>
          </div>
          <div class="col-md-6">
            <h5 class="fw-bold pb-2 ar-heading">Client</h5>
            <section>
              <p class="pb-4 ar-job-detail__client-name">
                <a href="#" [routerLink]="`/clients/${job.client_id}`">{{ job.client?.name }}</a>
              </p>
            </section>
          </div>
        </div>
        <div class="row">
          <div class="col">
            <app-contacts-table [rows]="rows"></app-contacts-table>
            <h5 class="fw-bold pt-5 pb-2 ar-heading">Art</h5>
            <section>
              @if (art$ | async; as artwork) {
                <div class="card-group ar-card-group overflow-y-auto ar-job-detail__art">
                  @if (artwork.length === 0) {
                    <span class="mt-3 ms-3">TBD</span>
                  } @else {
                    @for (art of artwork; track $index) {
                      <app-art-thumbnail-card
                        [art_id]="art.art_id"
                        [job_id]="jobId"
                        [artist_name]="art.artist?.name"
                        [draggable]="false"
                        class="ms-3 mt-3"
                      ></app-art-thumbnail-card>
                    }
                  }
                </div>
              }
            </section>
          </div>
        </div>
      }
    </div>
  </div>
</div>
<app-page-footer [footerData]="footerData"></app-page-footer>

<ng-template #nameTemplate let-row="row">
  @if (row.first_name && row.last_name) {
    {{ row.first_name }} {{ row.last_name }}
  }
</ng-template>

<div
  class="modal"
  id="confirmModal"
  tabindex="-1"
  aria-labelledby="confirmModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="confirmModalLabel">Are you sure?</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">Are you sure you want to delete this job from the system?</div>
      <div class="modal-footer">
        <button
          type="button"
          class="btn btn-danger"
          data-bs-dismiss="modal"
          (click)="onClickDelete()"
        >
          Yes, delete
        </button>
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
      </div>
    </div>
  </div>
</div>
