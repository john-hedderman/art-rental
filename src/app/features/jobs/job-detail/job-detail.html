<app-page-header [headerData]="headerData"></app-page-header>
<div class="container-fluid p-3 ar-page-content-no-menubar overflow-y-auto">
  @if (job$ | async; as job) {
  <div class="row">
    <div class="col">
      <h5 class="fw-bold pb-2 ar-heading">Job ID:</h5>
      <p class="pb-4">{{ job.id }}</p>
      <h5 class="fw-bold pb-2 ar-heading">Job Site:</h5>
      <p class="pb-4">
        {{ job.address1 }}<br />
        @if (job.address2) {
        {{ job.address2 }}<br />
        }
        {{ job.city }}, {{ job.state }} {{ job.zipCode }}
      </p>
    </div>
    <div class="col">
      <h5 class="fw-bold pb-2 ar-heading">Client:</h5>
      <p class="pb-4">
        <a href="#" [routerLink]="`/clients/${job.client.id}` ">{{ job.client.name }}</a>
      </p>
    </div>
  </div>
  <div class="row">
    <div class="col">
      <h5 class="fw-bold pb-2 ar-heading">Contacts:</h5>
      <ngx-datatable
        class="material mt-3"
        [rows]="rows"
        [columns]="columns"
        [columnMode]="'force'"
        [headerHeight]="50"
        [rowHeight]="50"
        [scrollbarV]="true"
      >
      </ngx-datatable>
      <p class="pb-4"></p>
      <h5 class="fw-bold pb-2 ar-heading">Art:</h5>
      @if (job.art && job.art.length) {
      <div class="card-group ar-card-group overflow-y-auto">
        @for (art of job.art; track $index) {
        <app-card
          [cardData]="{
            imageData: { source: art.url, alt: art.name, title: art.name },
            title: art.name,
            text: art.artist,
            clickHandler: util.handleArtCardClick.bind(null, art.id)
          }"
          class="mt-3 ms-3"
        ></app-card>
        }
      </div>
      }
    </div>
  </div>
  }
</div>

<ng-template #nameTemplate let-row="row">
  @if (row.firstName && row.lastName) {
  {{ row.firstName }} {{ row.lastName }}
  }
</ng-template>

<ng-template #clientNameTemplate let-value="value" let-row="row">
  {{ row.client?.name }}
</ng-template>
